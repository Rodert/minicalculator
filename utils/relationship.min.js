// 这里需要放置relationship库的实际代码内容
// 请从官方渠道获取最新版本：https://github.com/mumuy/relationship
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Relationship=e():t.Relationship=e()}(this,function(){return function(){var t={};function e(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return arguments[0][n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=arguments[0],e.c=t,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(){function t(t){this._data=this.parse(t)}return t.prototype.parse=function(t){var e=this,n={};return t.def.forEach(function(t){var r=t.params.split(","),o=t.text,i=t.sex,a=t.reverse;Array.isArray(o)||(o=[o]);var s=r.map(function(t){return e.parseParam(t)});e.walk(s,function(t){n[t]=n[t]||{},i&&(n[t].sex=i),a&&(n[t].reverse=a),n[t].text=o})}),n},t.prototype.parseParam=function(t){return t.replace(/\[.*?\]/g,"").replace(/s/g,"")},t.prototype.walk=function(t,e,n){void 0===n&&(n=[]);var r=this,o=n.length,i=t[o],a=t.slice(o+1);if(i){var s=i.split("|");s.forEach(function(t){var o=n.concat([t]);r.walk(t.split("|").map(function(t){return r.parseParam(t)}),e,o)})}else e(n)},t.prototype.chain=function(){return new s(this._data)},t}();function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t.split(',').map(function(t){var r=t.split('.');return e?r.slice(0,e).join('.'):r.slice(-1)[0]}).filter(function(t){return t}).join(n>1?",":"|")}var i=function(){function t(t){this.data=t,this.params=[],this.gender=1,this.type="default",this.reverse=!1}return t.prototype.setParams=function(t){return this.params=t,this},t.prototype.setGender=function(t){return this.gender=t,this},t.prototype.setType=function(t){return this.type=t,this},t.prototype.setReverse=function(t){return this.reverse=t,this},t.prototype.getResult=function(){for(var t=this.params.join(','),e=this.data[t],n=[];e;){if(e.text){var r=this.filter(e.text);if(r)return{text:r,sex:e.sex||this.gender,reverse:e.reverse}}n.push(t),t=o(t,1,1),e=this.data[t]}return{text:"关系无法确定",sex:this.gender,reverse:this.reverse}},t.prototype.filter=function(t){var e=this;if(Array.isArray(t)){var n=t.find(function(t){return e.checkCondition(t)});return n?n:t[0]}return this.checkCondition(t)?t:void 0},t.prototype.checkCondition=function(t){var e=/(?:[([^]]+)])/.exec(t);if(e){var n=e[1],r=!!/男/.test(n),o=!!/女/.test(n),i=this.gender;return!(r&&1!==i||o&&0!==i)}return!0},t}();var a=function(){function t(t){this.data=t.data}return t.prototype.setParams=function(t){return this.params=t,this},t.prototype.setGender=function(t){return this.gender=t,this},t.prototype.setType=function(t){return this.type=t,this},t.prototype.setReverse=function(t){return this.reverse=t,this},t.prototype.getResult=function(){for(var t=this.params,e=this.data,n=void 0,r=0;r<t.length;r++){var o=t[r],i=e[o];if(!i)return{text:"关系无法确定",sex:this.gender,reverse:this.reverse};e=i}n=e.text;var a=this.filter(n);return a?{text:a,sex:e.sex||this.gender,reverse:e.reverse}:{text:"关系无法确定",sex:this.gender,reverse:this.reverse}},t.prototype.filter=function(t){var e=this;if(Array.isArray(t)){var n=t.find(function(t){return e.checkCondition(t)});return n?n:t[0]}return this.checkCondition(t)?t:void 0},t.prototype.checkCondition=function(t){var e=/(?:[([^]]+)])/.exec(t);if(e){var n=e[1],r=!!/男/.test(n),o=!!/女/.test(n),i=this.gender;return!(r&&1!==i||o&&0!==i)}return!0},t}();var s=function(){function t(t){this.data=t,this.params=[],this.gender=1,this.type="default",this.reverse=!1}return t.prototype.setParams=function(t){return this.params=t,this},t.prototype.setGender=function(t){return this.gender=t,this},t.prototype.setType=function(t){return this.type=t,this},t.prototype.setReverse=function(t){return this.reverse=t,this},t.prototype.getResult=function(){try{var e=new a({data:this.data}).setParams(this.params).setGender(this.gender).setType(this.type).setReverse(this.reverse).getResult();if(e.text)return e}catch(t){}try{var n=new i(this.data).setParams(this.params).setGender(this.gender).setType(this.type).setReverse(this.reverse).getResult();if(n.text)return n}catch(t){}return{text:"关系无法确定",sex:this.gender,reverse:this.reverse}},t}();return r}()}]));